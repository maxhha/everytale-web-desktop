<!DOCTYPE html>
<html>
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- CSS -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500" rel="stylesheet">
    <link rel="stylesheet" href="/css/custom.css">

    <title>Расписание занятий</title>
  </head>
  <body>
    <div class="d-flex flex-column" style="width: 100vw; height: 100vh;">
        <!-- header bar -->
        <div class= "flex-shrink-0 flex-grow-0 d-flex justify-content-between timetable-header">
            <div class="d-flex">
                <div class="logo-top-bar">
                    <img src="/img/everytale-logo.svg">
                </div>

                <div class="d-flex d-flex-row timetable-view-week">
                    <h4 class="d-none d-md-block">Расписание занятий</h4>
                </div>
            </div>
            <div class="d-flex">
                <div class="d-flex timetable-mainmenu">
                    <a class="selected">
                        Расписание
                    </a>
                    <a>
                        Библиотека
                    </a>
                </div>
                <div class="search-btn"></div>
                <div class="profile-small">
                    <img src="/img/profile.png">
                </div>
            </div>
        </div>
        <!--/ header bar -->

        <div class="d-flex row-flex-xl-nowrap content">

            <div class = "filter-sidebar hidden">
                <span style="left:100%; position:relative; top: 0.5rem;">
                    <div class="toggle-filters-menu-btn"></div>
                </span>
            </div>

            <div class="week-list-scroll"></div>
        </div>
    </div>
    <!-- Templates -->
    <script id="filter-parameter-tmpl" type="text/x-handlebars-template">
        <div class="filter-parameter">
            <div class="filter-header">
                <div class="d-flex">
                    <img src="{{img}}">
                    <h5>{{name}}</h5>
                </div>
            </div>
            <ul class="filter-categories-list">
                {{#each category}}
                <li class="filter-category">
                    <div class="d-flex justify-content-between category-header">
                        <h5 class="category-name">{{this.name}}</h5>
                        <div class="open-category-btn">
                            <div class="chevron"></div>
                        </div>
                    </div>
                    <div class="category-positions">
                        <div class="collapse">
                            {{#each position}}
                            <input type="checkbox" id="param{{this.id}}" class="list-checkbox" {{#if this.checked}}checked{{/if}}>
                            <label for="param{{this.id}}">{{this.name}}</label>
                            {{/each}}
                        </div>
                    </div>
                </li>
                {{/each}}
            </ul>
        </div>
    </script>
    <script id="day-tmpl" type="text/x-handlebars-template">
        <div class="day-place {{#if today}}current{{/if}}">
            <div class="day-card">

                <div class="d-flex justify-content-between day-header">
                    <div class="weekday">
                        {{name}}
                    </div>
                    <div class="d-flex justify-content-between flex-grow-1">
                        <div class="date">{{date}}</div>
                        <div class="today-label">Сегодня</div>
                    </div>
                </div>
                {{#each events}}
                <div class="timetable-event">
                    <div class="d-flex event-header">
                        <div class="flex-shrink-0 flex-grow-0">
                            <div class="event-start-time">{{this.timestart}}</div>
                            <div class="event-finish-time">{{this.timefinish}}</div>
                        </div>
                        <a class="event-name" href="{{this.url}}">{{this.name}}</a>
                    </div>
                    <div class="d-flex justify-content-between event-icons-bar">
                        <div class="d-flex">
                            <span class="event-icon icon-lecturer"></span>
                            <span class="event-icon icon-place"></span>
                            <span class="event-icon icon-info"></span>
                        </div>
                        <div class="d-flex justify-content-end">
                            <span class="event-icon icon-paper {{#if this.hasDocument}}{{else}}disabled{{/if}}"></span>
                            <span class="event-icon icon-clip {{#if this.hasFile}}{{else}}disabled{{/if}}"></span>
                        </div>
                    </div>
                </div>
                {{/each}}
            </div>
        </div>
    </script>
    <!-- END Templates -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.1.1/handlebars.min.js" integrity="sha256-Mki72593zH3nxiQrW1mskmSOAXOep8FVIK0ozKFISyY=" crossorigin="anonymous"></script>
    <script>
        (function(){
            var filterTempl = Handlebars.compile($("#filter-parameter-tmpl").html());

            var filters = [{
                name: "Подключенный спискок",
                img : "/img/eye.svg",
                category: [
                    {
                        name: "МГТУ им Н.Э. Баумана",
                        position: [{
                            name: "ИУ9-43Б",
                            id: "1",
                            checked: false
                        }, {
                            name: "Технопарк Python-14",
                            id: "2",
                            checked: false
                        }]
                    },{
                        name: "Digital Conference",
                        position: [{
                            name: "NLP/Machine Learning",
                            id: "3",
                            checked: false
                        }]
                    }
                ]
            }];
            var target = $('.filter-sidebar');
            filters.forEach(function(filter){
                target.append(filterTempl(filter));
            });
        })();

        (function(){
            var dayTmpl = Handlebars.compile($("#day-tmpl").html());
            var weekdays = [{
                name: "Понедельник",
                date: "15.04",
                today: true,
                events: [{
                    name: "Обыкновенные дифференциальные уравнения",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#",
                    hasDocument: true,
                    hasFile: true
                },{
                    name: "Операционные системы",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#",
                    hasDocument: true,
                    hasFile: true
                },{
                    name: "Алгоритмы компьютерной графики",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#",
                    hasDocument: true,
                    hasFile: false
                }]
            },{
                name: "Вторник",
                date: "16.04",
                today: false,
                events: [{
                    name: "Обыкновенные дифференциальные уравнения",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#",
                    hasDocument: false,
                    hasFile: true
                },{
                    name: "Операционные системы",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#",
                    hasDocument: true,
                    hasFile: true
                },{
                    name: "Алгоритмы компьютерной графики",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#"
                }]
            },{
                name: "Среда",
                date: "17.04",
                today: false,
                events: [{
                    name: "Обыкновенные дифференциальные уравнения",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#"
                },{
                    name: "Операционные системы",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#"
                },{
                    name: "Алгоритмы компьютерной графики",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#"
                }]
            },{
                name: "Четверг",
                date: "18.04",
                today: false,
                events: [{
                    name: "Обыкновенные дифференциальные уравнения",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#"
                },{
                    name: "Операционные системы",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#"
                },{
                    name: "Алгоритмы компьютерной графики",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#"
                }]
            },,{
                name: "Пятница",
                date: "19.04",
                today: false,
                events: [{
                    name: "Обыкновенные дифференциальные уравнения",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#"
                },{
                    name: "Операционные системы",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#"
                },{
                    name: "Алгоритмы компьютерной графики",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#"
                }]
            },{
                name: "Суббота",
                date: "20.04",
                today: false,
                events: [{
                    name: "Алгоритмы компьютерной графики",
                    timestart: "10:15",
                    timefinish: "11:50",
                    url:"#"
                }]
            },{
                name: "Воскресенье",
                date: "21.04",
                today: false,
                events: []
            }];
            var target = $(".week-list-scroll")
            weekdays.forEach(function(data){
                target.append(dayTmpl(data));
            });
        })();

        $(".category-header").on("click", function(){
            if ($(this).is('.show')) {
                $(this).removeClass("show");
                $(this).parent().find(".collapse").hide(350);
            } else {
                $(this).addClass("show");
                var collapseItem = $(this).parent().find(".collapse");
                collapseItem.show(350);
            }
        });

        $(".toggle-filters-menu-btn").on("click", function(){
            if ($(this).is('.show')) {
                $(this).removeClass("show");
                $(".filter-sidebar").addClass('hidden');
                $(".filter-parameter").css("display", 'none');
            } else {
                $(this).addClass("show");
                $(".filter-sidebar").removeClass('hidden');
                $(".filter-parameter").css("display", 'none');
            }
        });
        $(".filter-sidebar").on('transitionend', function(){
            if (!$(this).is('.hidden')){
                $(".filter-parameter").css("display", 'block');
            }
        });

    </script>
  </body>
</html>
